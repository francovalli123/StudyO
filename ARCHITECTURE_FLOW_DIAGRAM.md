# loadWeeklyChallenge() - Flow Diagram & Architecture

## ğŸ“Š Flujo de EjecuciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. loadDashboard() se ejecuta al cargar dashboard.html          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Promise.all([]) inicia carga paralela de datos               â”‚
â”‚    - loadHabitsStats()                                          â”‚
â”‚    - loadSubjectsStats()                                        â”‚
â”‚    - loadPomodoroStats()                                        â”‚
â”‚    - loadWeeklyObjectives()                                     â”‚
â”‚    - loadWeeklyChallenge()  â—„â”€â”€â”€â”€â”€â”€â”€â”€ NOS INTERESA ESTE        â”‚
â”‚    - loadWeeklyStudyRhythm()                                    â”‚
â”‚    - loadFocusDistribution()                                    â”‚
â”‚    - loadPeakProductivity()                                     â”‚
â”‚    - loadKeyHabits()                                            â”‚
â”‚    - loadNextEvent()                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ loadWeeklyChallenge()      â”‚
         â”‚ INICIA AQUÃ                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Hacer GET /api/...active/    â”‚
        â”‚ (con JWT token automÃ¡tico)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Â¿Respuesta OK?             â”‚
         â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
            â”‚                        â”‚
         SÃ â”‚                        â”‚ NO
            â”‚                        â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ JSON parse OK?  â”‚    â”‚ Error handler  â”‚
     â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜    â”‚ mostrar estado â”‚
        â”‚            â”‚      â”‚ de error       â”‚
     SÃ â”‚            â”‚ NO   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Data   â”‚   â”‚ Challenge nullâ”‚
   â”‚vÃ¡lida? â”‚   â”‚ mostrar vacÃ­o â”‚
   â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  SÃ â”‚    â”‚ NO
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                        â”‚
     â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ renderWeeklyChallengeUI()               â”‚
â”‚ (recibe datos + porcentaje)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
               â”‚                        â”‚
         Completado?           Activo?
               â”‚                        â”‚
               â–¼                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Verde âœ“     â”‚        â”‚ PÃºrpura âš¡   â”‚
        â”‚ Esmeralda   â”‚        â”‚ Rosa         â”‚
        â”‚ +50 XP      â”‚        â”‚ +50 XP       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                        â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Renderizar HTML en      â”‚
                â”‚ [data-challenge-...     â”‚
                â”‚ container]              â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ lucide.createIcons()     â”‚
                â”‚ Actualizar iconos       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Arquitectura de Componentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ dashboard.html                                           â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ <div data-challenge-container>                       â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   <!-- Renderizado por loadWeeklyChallenge() -->     â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ </div>                                               â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ dashboard.ts                                             â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ export async function loadWeeklyChallenge()          â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ apiGet("/weekly-challenge/active/")            â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ renderWeeklyChallengeUI(challenge, %)          â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ function renderWeeklyChallengeUI()                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ Procesar datos                                â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ Generar HTML                                 â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ Insertar en DOM                              â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ api.ts                                                   â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ export async function apiGet<T>(path: string)        â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ fetch(BASE_URL + path)                          â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ getHeaders() + Token                            â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ handleRequest<T>()                              â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ HTTP GET
                          â”‚ /api/weekly-challenge/active/
                          â”‚ Authorization: Token <TOKEN>
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BACKEND                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ views.py: ActiveWeeklyChallengeView                      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ permission_classes = [IsAuthenticated]               â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ def get(request):                                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ filter(user=request.user, status='active')    â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ order_by('-week_start').first()              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ return Response(serialize(challenge))        â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ serializers.py: WeeklyChallengeSerializer               â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ Fields:                                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ id                                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ title (get_title)                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ description (get_description)                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ progress (len(completed_days))                â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ progress_percentage (calcula)                 â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ current_value (= progress)                    â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ target_value (= target_days)                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ status                                         â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ ... (mÃ¡s campos)                              â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ models.py: WeeklyChallenge                              â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ Fields:                                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ user (FK)                                       â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ week_start (Date)                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ week_end (Date)                                â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ target_days (5 por defecto)                    â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ required_pomodoros_per_day (5)                 â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ completed_days (JSONField list)                â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ status ('active'|'completed'|'failed')         â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ Methods:                                             â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â”œâ”€ get_title() â†’ str                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  â””â”€ get_description() â†’ str                        â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser      â”‚
â”‚ localStorage â”‚
â”‚ authToken    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ localStorage.getItem('authToken')
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ apiGet()                        â”‚
â”‚ â€¢ Recupera token               â”‚
â”‚ â€¢ Construye headers            â”‚
â”‚ â€¢ Authorization: Token <TOKEN> â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
       â”‚                        â”‚
    GETâ”‚                        â”‚ Headers
       â–¼                        â–¼
    Path: /api/weekly-challenge/active/
       â”‚
       â”‚ HTTP Request
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend API                      â”‚
â”‚ IsAuthenticated Permission Check â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ âœ“ Valid
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query DB                         â”‚
â”‚ .filter(user=user, status='...')â”‚
â”‚ .order_by('-week_start').first()â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Challenge Found (or None)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Serialize Data                   â”‚
â”‚ WeeklyChallengeSerializer()      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ JSON Response
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP 200 OK                      â”‚
â”‚ {                                â”‚
â”‚   "id": 1,                       â”‚
â”‚   "title": "...",                â”‚
â”‚   "description": "...",          â”‚
â”‚   "progress": 3,                 â”‚
â”‚   "progress_percentage": 60.0,   â”‚
â”‚   "status": "active",            â”‚
â”‚   ...                            â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTP Response
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser receives JSON            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ const challenge = await res.json()
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ loadWeeklyChallenge()            â”‚
â”‚ â€¢ Valida datos                   â”‚
â”‚ â€¢ Calcula progress_percentage    â”‚
â”‚ â€¢ Llama renderWeekly...()        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ renderWeeklyChallengeUI()        â”‚
â”‚ â€¢ Procesa estado (active/...     â”‚
â”‚ â€¢ Genera HTML dinamically        â”‚
â”‚ â€¢ querySelector('[data-chall...]'â”‚
â”‚ â€¢ innerHTML = HTML               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOM Update                       â”‚
â”‚ [data-challenge-container]       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ lucide.createIcons()             â”‚
â”‚ Renderiza iconos SVG             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Secuencia de Timing

```
Time (ms)
â”‚
0    â”‚ â”Œâ”€ Page Load (DOMContentLoaded)
     â”‚ â”‚
50   â”‚ â”œâ”€ loadDashboard() inicia
     â”‚ â”‚  â””â”€ Promise.all([...]) inicia
     â”‚ â”‚
100  â”‚ â”œâ”€ MÃºltiples GET requests inician en paralelo
     â”‚ â”‚  â”œâ”€ GET /api/habits/           â† Otros
     â”‚ â”‚  â”œâ”€ GET /api/subjects/         â† Otros
     â”‚ â”‚  â”œâ”€ GET /api/weekly-challenge/active/  â† NUESTRO
     â”‚ â”‚  â””â”€ ...
     â”‚ â”‚
300  â”‚ â”œâ”€ Respuestas empiezan a llegar
     â”‚ â”‚  â””â”€ Challenge responde primero (mÃ¡s rÃ¡pido)
     â”‚ â”‚
350  â”‚ â”œâ”€ loadWeeklyChallenge() procesa datos
     â”‚ â”‚  â”œâ”€ Valida response
     â”‚ â”‚  â”œâ”€ Calcula progress_percentage
     â”‚ â”‚  â””â”€ Llama renderWeeklyChallengeUI()
     â”‚ â”‚
400  â”‚ â”œâ”€ DOM updates
     â”‚ â”‚  â”œâ”€ querySelector('[data-challenge-container]')
     â”‚ â”‚  â”œâ”€ .innerHTML = HTML
     â”‚ â”‚  â””â”€ lucide.createIcons()
     â”‚ â”‚
420  â”‚ â”œâ”€ DesafÃ­o visible en pantalla âœ“
     â”‚ â”‚
500  â”‚ â”œâ”€ Otras cargas terminan
     â”‚ â”‚
550  â”‚ â””â”€ Promise.all() completa
     â”‚    Dashboard totalmente cargado âœ“
```

---

## ğŸ›¡ï¸ Error Handling Flow

```
â”Œâ”€ loadWeeklyChallenge() inicia
â”‚
â”œâ”€ try {
â”‚  â”‚
â”‚  â”œâ”€ const challenge = await apiGet(...)
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Si status 401:
â”‚  â”‚  â”‚  â””â”€ Throw error (Session expired)
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Si status 404:
â”‚  â”‚  â”‚  â””â”€ Throw error (Not found)
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Si status 500:
â”‚  â”‚  â”‚  â””â”€ Throw error (Server error)
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ Si 200 con JSON vÃ¡lido:
â”‚  â”‚     â””â”€ Challenge object OK âœ“
â”‚  â”‚
â”‚  â”œâ”€ if (!challenge) {
â”‚  â”‚  â””â”€ renderEmptyState()
â”‚  â”‚
â”‚  â”œâ”€ const progressPercent = calcular...
â”‚  â”‚
â”‚  â””â”€ renderWeeklyChallengeUI(challenge, percent)
â”‚
â”œâ”€ } catch (error) {
â”‚  â”‚
â”‚  â”œâ”€ console.error(error)
â”‚  â”‚
â”‚  â””â”€ renderErrorState()
â”‚
â””â”€ End
```

---

## ğŸ“± Component Hierarchy

```
<main>
  â””â”€ .p-8
     â””â”€ <div class="grid grid-cols-1 lg:grid-cols-2">
        â””â”€ <div class="bg-dark-card rounded-3xl">
           â”‚
           â”œâ”€ <div class="flex justify-between items-start">
           â”‚  â”œâ”€ <h2> DesafÃ­o Semanal Activo
           â”‚  â””â”€ <i data-lucide="award">
           â”‚
           â””â”€ <div data-challenge-container>  â—„â”€â”€ TARGET
              â”‚
              â”œâ”€ [Si activo]
              â”‚  â”œâ”€ <div class="space-y-4">
              â”‚  â”‚  â”œâ”€ <div class="flex justify-between">
              â”‚  â”‚  â”‚  â”œâ”€ <h3> TÃ­tulo dinÃ¡mico
              â”‚  â”‚  â”‚  â”œâ”€ <p> DescripciÃ³n
              â”‚  â”‚  â”‚  â””â”€ <span class="badge"> Estado
              â”‚  â”‚  â”œâ”€ <div class="space-y-2">
              â”‚  â”‚  â”‚  â”œâ”€ <div class="progress-bar">
              â”‚  â”‚  â”‚  â””â”€ <div class="flex justify-between">
              â”‚  â”‚  â””â”€ <div class="reward">
              â”‚  â”‚     â””â”€ Recompensa: +50 XP
              â”‚  â”‚
              â”‚  â””â”€ </div>
              â”‚
              â”œâ”€ [Si sin desafÃ­o]
              â”‚  â””â”€ <div class="text-center">
              â”‚     â”œâ”€ <i data-lucide="award">
              â”‚     â””â”€ <p> No hay desafÃ­o activo
              â”‚
              â””â”€ [Si error]
                 â””â”€ <div class="text-center">
                    â””â”€ <p class="text-red-400"> Error al cargar
```

---

## ğŸ”— Dependencies

```
dashboard.ts
â”œâ”€ Imports from "./api.js"
â”‚  â””â”€ apiGet()
â”œâ”€ Uses localStorage
â”‚  â””â”€ getItem('authToken')
â”œâ”€ Uses global lucide
â”‚  â””â”€ lucide.createIcons()
â””â”€ Interfaces
   â””â”€ WeeklyChallenge

dashboard.html
â”œâ”€ Estructura HTML base
â””â”€ Elemento [data-challenge-container]

models.py
â”œâ”€ WeeklyChallenge model
â”œâ”€ Methods: get_title(), get_description()
â””â”€ Fields: completed_days, status, target_days

serializers.py
â”œâ”€ WeeklyChallengeSerializer
â”œâ”€ Methods: get_progress(), get_progress_percentage()
â””â”€ Fields mapping

views.py
â”œâ”€ ActiveWeeklyChallengeView
â”œâ”€ permission_classes: [IsAuthenticated]
â””â”€ GET method implementation
```

---

**Diagram Version:** 1.0  
**Last Updated:** Feb 1, 2026
